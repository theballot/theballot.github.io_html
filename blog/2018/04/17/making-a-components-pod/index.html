<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Making a React Native Components Pod - Artsy Engineering</title>
  <meta name="author" content="">

  
  <meta name="description" content="When we talk about our React Native setup in abstract, there are two kinds of "now draw The Tick" for
iOS developers:


How do I build this React N...">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:image" content="http://artsy.github.io/images/artsy_oss_image.png" />
  <meta property="og:image:type" content="image/png" />

  
  <link rel="canonical" href="http://artsy.github.io/blog/2018/04/17/making-a-components-pod/">
  <link rel="alternate" type="application/rss+xml" title="Artsy Engineering Blog" href="/feed">

  <link href="/favicon.ico" rel="icon">
  <link href="/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">

  <script src="/javascripts/jquery-1.11.3.min.js"> </script>
  <script src="/javascripts/gradient-fade.js"></script>
  <script src="/javascripts/noframework.waypoints.min.js"></script>
  <script src="/javascripts/sticky.min.js"></script>
  <script src="/javascripts/search.min.js"></script>

  

  <script type="text/javascript" src="https://fast.fonts.net/jsapi/f7f47a40-b25b-44ee-9f9c-cfdfc8bb2741.js"></script>


  <link href="" rel="alternate" title="Artsy Engineering" type="application/atom+xml">
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-12450662-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  <!--[if IE 8]><link href="/stylesheets/custom/ie_font.css" type="text/css"><![endif]-->

</head>


<link href="/css/epic.css" media="screen, projection" rel="stylesheet" type="text/css">


<link href="/css/posts/what-is-react-native.css" media="screen, projection" rel="stylesheet" type="text/css">


<body>
  <div>
    <div id="bodywrapper">
      <header>
        <ul>
          <li><a href="/">Artsy Engineering Blog</a></li>
          <li><a href="https://www.artsy.net/jobs">Careers</a></li>
          <li><a href="https://developers.artsy.net">API</a></li>
        </ul>

        <ul>
          <li><a href="http://artsy.github.io/open-source/">Our Open Source</a></li>
          <li><a href="http://twitter.com/artsyopensource">@artsyopensource</a></li>
          <li><a href="https://www.artsy.net">artsy.net</a></li>
        </ul>
      </header>

      <section>
        <header id="page">
          <h1>Making a React Native Components Pod</h1>
          <h3>
          <!-- Yep, single line so the comma lines up right -->
          By  Orta Therox
          </h3>
        </header>

        <article class='post'>
          <p>When we talk about our React Native setup in abstract, there are two kinds of "<a href="http://2.bp.blogspot.com/_PekcT72-PGE/SK3PTKwW_eI/AAAAAAAAAGY/ALg_ApHyzR8/s1600-h/1219140692800.jpg">now draw The Tick</a>" for
iOS developers:</p>

<ul>
<li>How do I build this React Native as a CocoaPods setup?</li>
<li>How do I get all the JavaScript tooling setup up?</li>
</ul>


<p>We're going to address the first part in this post. By the end of this post we're going to get an <a href="/blog/2016/08/24/On-Emission/">Emission-like
repo</a> set up for an existing OSS Swift iOS app called <a href="https://github.com/GitHawkApp/GitHawk/">GitHawk</a>. The aim being to introduce no
JavaScript tooling into GitHawk itself, and to only expose iOS-native <code>UIViewControllers</code> via a CocoaPod which is
consumed by GitHawk.</p>

<p>To do this we're going to use the CocoaPods' <code>pod lib create</code> template, and React Native's <code>react-native init</code> to
make a self-contained React Native repo. It will export a JS file, and some native code which Podspec will
reference. This keeps the tooling complexity for iOS and React Native separate. Read on to start digging in.</p>

<!-- more -->


<p>So, I'm <strong>choosing</strong> to be annoying here. I will intentionally be adding <code>$</code>s before all of the commands, this is
specifically to slow you down and make you think about each command. This isn't a quick tutorial you can skim in 2
minutes, running though it properly should take about an hour.</p>

<p>_You can also watch along with <a href="https://www.youtube.com/watch?v=ucQXL4vkP78">this YouTube video</a> of me going through
the tutorial at <a href="http://artsy.github.io/artsy-x-react-native.html">Artsy x React Native_</a>.</p>

<div class="mobile-only">
<p>
  <strong>Also, before you get started</strong>, it looks like you're using a really small screen, this post expects you would have a terminal around with useful tools for getting stuff done. I'm afraid without that, you're not going to get much out of it. I'd recommend switching to a computer.
</p>
</div>


<a name="What.Are.We.Going.To.Do."></a>
<h2>What Are We Going To Do?</h2>

<p>We will make a React Native components library (GitDawg) for an existing open-source iOS Swift Application
(GitHawk). This reflects an existing app with a team who wants to experiment with React Native in a way that doesn't
affect the main codebase. In Artsy, GitDawg is <a href="https://github.com/artsy/emission">Emission</a>, and GitHawk is <a href="https://github.com/artsy/eigen">Eigen</a>.</p>

<ol>
<li><p>We will clone and set up GitHawk</p></li>
<li><p>We will use <code>pod lib create</code> to make a library repo called GitDawg</p></li>
<li><p>We will use <code>react-native init</code> to make a React Native environment</p></li>
<li><p>We will bundle the React Native code into our Pod's asset folder</p></li>
<li><p>We will edit the Podspec for GitDawg, and then the Podfile for the example project to consume it</p></li>
<li><p>We will use <a href="https://github.com/orta/cocoapods-fix-react-native#readme">cocoapods-fix-react-native</a> to hotfix the React Native files</p></li>
<li><p>We will expose a UIViewController which corresponds to the default screen from <code>react-native init</code> in our Pod</p></li>
<li><p>We will change the storyboard reference to point to the UIViewController from our Pod, and run the simulator to
see our welcome screen.</p></li>
<li><p>We will set up GitHawk to consume our new Pod</p></li>
<li><p>We will change GitHawk to show our new UIViewController instead of the bookmarks screen</p></li>
<li><p>We will edit GitDawg to act more like a development environment</p></li>
</ol>


<a name="GitHawk"></a>
<h2>GitHawk</h2>

<p>Let's get started by having a working <a href="https://github.com/GitHawkApp/GitHawk/">copy of GitHawk</a>. I'll leave the README for GitHawk to do that, but
if you want to be certain you're on the same version as me - I'm working from this commit
<code>6dc2988d23d70eb0862d11f4a365bf47a87848c6</code>.</p>

<p>Clone a copy of GitHawk, and get it running in your Simulator, should take about 5-10 minutes, you'll need Xcode
9.3. Then we can move on to starting our components repo.</p>

<a name="GitDawg.JS"></a>
<h2>GitDawg JS</h2>

<p>When you're done with GitHawk, go back a folder so that you're ready to create the GitDawg repo: <code>$ cd ..</code>.</p>

<a name="Pre-requisites"></a>
<h3>Pre-requisites</h3>

<p>We need CocoaPods: <code>$ gem install cocoapods</code>.</p>

<p>We're going to need node, and a dependency manager. If you run <code>$ brew install yarn</code> you will get both.</p>

<p>I'm running on node <code>8.9.x</code> and yarn <code>1.5.x</code>. Honestly, it shouldn't matter if you're on node 8, or 9. Yarn is
basically CocoaPods for node projects. If you're wondering what the differences are between <a href="https://github.com/yarnpkg/yarn/">yarn</a> and <a href="https://www.npmjs.com/">NPM</a>,
then TLDR: there used to be some, but now there's few. I stick with yarn because I prefer how the CLI works, and I
can easily read the lockfile it generates.</p>

<p>We need the React Native CLI, so let's install it globally: <code>$ yarn global add react-native-cli</code>.</p>

<a name="Starting.with.the.Pod"></a>
<h3>Starting with the Pod</h3>

<p>We're going to let CocoaPods create the initial folder for our project. Let's set up your Pod:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>pod lib create GitDawg
</span><span class='line'>
</span><span class='line'>Cloning <span class="sb">`</span>https://github.com/CocoaPods/pod-template.git<span class="sb">`</span> into <span class="sb">`</span>GitDawg<span class="sb">`</span>.
</span><span class='line'>Configuring GitDawg template.
</span><span class='line'>
</span><span class='line'>------------------------------
</span><span class='line'>
</span><span class='line'>To get you started we need to ask a few questions, this should only take a minute.
</span><span class='line'>
</span><span class='line'>If this is your first <span class="nb">time </span>we recommend running through with the guide:
</span><span class='line'> - http://guides.cocoapods.org/making/using-pod-lib-create.html
</span><span class='line'> <span class="o">(</span> hold cmd and click links to open in a browser. <span class="o">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>What platform <span class="k">do</span> you want to use?? <span class="o">[</span> iOS / macOS <span class="o">]</span>
</span><span class='line'> &gt; iOS
</span><span class='line'>
</span><span class='line'>What language <span class="k">do</span> you want to use?? <span class="o">[</span> Swift / ObjC <span class="o">]</span>
</span><span class='line'> &gt; ObjC
</span><span class='line'>
</span><span class='line'>Would you like to include a demo application with your library? <span class="o">[</span> Yes / No <span class="o">]</span>
</span><span class='line'> &gt; Yes
</span><span class='line'>
</span><span class='line'>Which testing frameworks will you use? <span class="o">[</span> Specta / Kiwi / None <span class="o">]</span>
</span><span class='line'> &gt; None
</span><span class='line'>
</span><span class='line'>Would you like to <span class="k">do</span> view based testing? <span class="o">[</span> Yes / No <span class="o">]</span>
</span><span class='line'> &gt; No
</span><span class='line'>
</span><span class='line'>What is your class prefix?
</span><span class='line'> &gt; GD
</span></code></pre></td></tr></table></div></figure>


<p>I'd recommend using only Objective-C at this point, for simplicities sake. Swift is a great language, but I want
tooling simplicity. Swift and React Native is [docs] though. We're also not going to write enough native code to
warrant the setup for testing. Plus, if we skip native testing then we can run CI on linux - which is basically
instant in comparison.</p>

<p>This has made a new library. Let's go into our project's root with <code>$ cd GitDawg</code>. There shouldn't be too much in
here:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>ls
</span><span class='line'>Example         GitDawg         GitDawg.podspec LICENSE         README.md         _Pods.xcodeproj
</span></code></pre></td></tr></table></div></figure>


<p>Because the core competency of the repo is the JavaScript, we're going to rename the "GitDawg" folder in the root to
be about the CocoaPod instead of owning the name of the project. Run <code>$ mv GitDawg Pod</code> to do that.</p>

<p>We want to create our React Native project. I'm hard-coding my versions in these commands to try ensure this post
lasts some time, but you never know what amazing changes the future brings. If things are broken, leave a comment at
the bottom of this post.</p>

<p>Let’s create a GitDawg React Native project, and then rename the folder to src:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># Use the RN CLI to create a new RN app in the folder GitDawg</span>
</span><span class='line'><span class="nv">$ </span>react-native init GitDawg --version react-native@0.54.4
</span><span class='line'>
</span><span class='line'><span class="c"># Rename the folder to src</span>
</span><span class='line'><span class="nv">$ </span>mv GitDawg src
</span><span class='line'>
</span><span class='line'><span class="c"># Remove _Pods.xcodeproj as it&#39;s relevant for our pod</span>
</span><span class='line'><span class="nv">$ </span>rm -rf _Pods.xcodeproj
</span></code></pre></td></tr></table></div></figure>


<p>We don't want all our project files living in a sub-folder though, so let's move a few of them back to the repo's
root, then remove some unused files.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># Copy the package metadata, deps, lockfile and dotfiles to root</span>
</span><span class='line'><span class="nv">$ </span>mv src/package.json src/node_modules src/yarn.lock src/.* .
</span><span class='line'>
</span><span class='line'><span class="c"># Remove the ios and android scaffolds as we have the CP one</span>
</span><span class='line'><span class="nv">$ </span>rm -rf src/ios src/android
</span></code></pre></td></tr></table></div></figure>


<p>Which should make your app's folder look something like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>ls
</span><span class='line'>Example         GitDawg.podspec LICENSE         README.md       Pods        node_modules    package.json    src             yarn.lock
</span><span class='line'>
</span><span class='line'><span class="nv">$ </span>ls src/
</span><span class='line'>App.js    __tests__ app.json  index.js
</span></code></pre></td></tr></table></div></figure>


<p>To ensure everything is still hooked up, let's make sure that all of your tests are working in the new repo.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>yarn <span class="nb">test</span>
</span><span class='line'>
</span><span class='line'>yarn run v1.5.1
</span><span class='line'> PASS  src/__tests__/App.js
</span><span class='line'>  ✓ renders correctly <span class="o">(</span>176ms<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>Test Suites: <span class="m">1</span> passed, <span class="m">1</span> total
</span><span class='line'>Tests:       <span class="m">1</span> passed, <span class="m">1</span> total
</span><span class='line'>Snapshots:   <span class="m">0</span> total
</span><span class='line'>Time:        1.392s
</span><span class='line'>Ran all <span class="nb">test </span>suites.
</span><span class='line'>✨  Done in 2.32s.
</span></code></pre></td></tr></table></div></figure>


<p>We're now going to be done with our JavaScript side, basically is our React Native "hello world". It's a React
Native project that exposes a single component which says <code>"Welcome to React Native!"</code>.</p>

<p>However, it's going to take a bit of work before we can see it in action.</p>

<a name="Deployment"></a>
<h3>Deployment</h3>

<p>We're going to want to have this exposed to our native libraries, so we're going to ship the bundled JavaScript as
our library's source code. We do this via the React Native CLI, and it's going to place the file inside our Pod
folder from earlier.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>react-native bundle --entry-file src/index.js --bundle-output Pod/Assets/GitDawg.js --assets-dest Pod/Assets
</span></code></pre></td></tr></table></div></figure>


<p>It looks like this, when you run it via the sim:</p>

<center><img src="/images/making_cp_pod/success.png" width="50%" /></center>


<a name="GitDawg.Pod"></a>
<h2>GitDawg Pod</h2>

<p>With that done, we can start looking at the native side of our codebase. We let <code>pod lib create</code> set up an Example
app for us to work with in the repo, which consumes a Podspec in the root. So we're going to take a look at the
Podspec, and update it.</p>

<p>Our goal with the Example app is to set up an app exclusively for developing components in. In Artsy's case, this
app handles auth to the Artsy API and has a series of jump-off points for developing a component.</p>

<p>To get started we need to modify the CocoaPod this repo represents:</p>

<ul>
<li>Update our Podspec to handle React Native as a dependency, and our assets</li>
<li>Add support for native compilation via CocoaPods with <a href="https://github.com/orta/cocoapods-fix-react-native#readme">cocoapods-fix-react-native</a></li>
<li>Create a single <code>UIViewController</code> subclass for the Welcome Screen using the bundled React Native JS</li>
</ul>


<p>We want to have our Podspec re-use the metadata from React Native to set up GitDawg's dependencies. So replace
<code>GitDawg.podspec</code> with this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;json&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Returns the version number for a package.json file</span>
</span><span class='line'><span class="n">pkg_version</span> <span class="o">=</span> <span class="nb">lambda</span> <span class="k">do</span> <span class="o">|</span><span class="n">dir_from_root</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s1">&#39;version&#39;</span><span class="o">|</span>
</span><span class='line'>  <span class="n">path</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">__dir__</span><span class="p">,</span> <span class="n">dir_from_root</span><span class="p">,</span> <span class="s1">&#39;package.json&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="no">JSON</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">path</span><span class="p">))</span><span class="o">[</span><span class="n">version</span><span class="o">]</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Let the main package.json decide the version number for the pod</span>
</span><span class='line'><span class="n">gitdawg_version</span> <span class="o">=</span> <span class="n">pkg_version</span><span class="o">.</span><span class="n">call</span>
</span><span class='line'><span class="c1"># Use the same RN version that the JS tools use</span>
</span><span class='line'><span class="n">react_native_version</span> <span class="o">=</span> <span class="n">pkg_version</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s1">&#39;node_modules/react-native&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="no">Pod</span><span class="o">::</span><span class="no">Spec</span><span class="o">.</span><span class="n">new</span> <span class="k">do</span> <span class="o">|</span><span class="n">s</span><span class="o">|</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">name</span>             <span class="o">=</span> <span class="s1">&#39;GitDawg&#39;</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">version</span>          <span class="o">=</span> <span class="n">gitdawg_version</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">description</span>      <span class="o">=</span> <span class="s1">&#39;Components for GitHawk.&#39;</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">summary</span>          <span class="o">=</span> <span class="s1">&#39;Components for GitHawk.&#39;</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">homepage</span>         <span class="o">=</span> <span class="s1">&#39;https://github.com/orta/GitDawg&#39;</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">license</span>          <span class="o">=</span> <span class="p">{</span> <span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;MIT&#39;</span><span class="p">,</span> <span class="ss">file</span><span class="p">:</span> <span class="s1">&#39;LICENSE&#39;</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">author</span>           <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;orta&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;orta.therox@gmail.com&#39;</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">source</span>           <span class="o">=</span> <span class="p">{</span> <span class="ss">git</span><span class="p">:</span> <span class="s1">&#39;https://github.com/orta/GitDawg.git&#39;</span><span class="p">,</span> <span class="ss">tag</span><span class="p">:</span> <span class="n">s</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">to_s</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">source_files</span>   <span class="o">=</span> <span class="s1">&#39;Pod/Classes/**/*.{h,m}&#39;</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">resources</span>      <span class="o">=</span> <span class="s1">&#39;Pod/Assets/{GitDawg.js,assets}&#39;</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">platform</span>       <span class="o">=</span> <span class="ss">:ios</span><span class="p">,</span> <span class="s1">&#39;8.0&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># React is split into a set of subspecs, these are the essentials</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">&#39;React/Core&#39;</span><span class="p">,</span> <span class="n">react_native_version</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">&#39;React/CxxBridge&#39;</span><span class="p">,</span> <span class="n">react_native_version</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">&#39;React/RCTAnimation&#39;</span><span class="p">,</span> <span class="n">react_native_version</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">&#39;React/RCTImage&#39;</span><span class="p">,</span> <span class="n">react_native_version</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">&#39;React/RCTLinkingIOS&#39;</span><span class="p">,</span> <span class="n">react_native_version</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">&#39;React/RCTNetwork&#39;</span><span class="p">,</span> <span class="n">react_native_version</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">&#39;React/RCTText&#39;</span><span class="p">,</span> <span class="n">react_native_version</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># React&#39;s dependencies</span>
</span><span class='line'>  <span class="n">s</span><span class="o">.</span><span class="n">dependency</span> <span class="s1">&#39;yoga&#39;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">react_native_version</span><span class="si">}</span><span class="s2">.React&quot;</span>
</span><span class='line'>  <span class="n">podspecs</span> <span class="o">=</span> <span class="o">[</span>
</span><span class='line'>    <span class="s1">&#39;node_modules/react-native/third-party-podspecs/DoubleConversion.podspec&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="s1">&#39;node_modules/react-native/third-party-podspecs/Folly.podspec&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="s1">&#39;node_modules/react-native/third-party-podspecs/glog.podspec&#39;</span>
</span><span class='line'>  <span class="o">]</span>
</span><span class='line'>  <span class="n">podspecs</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">podspec_path</span><span class="o">|</span>
</span><span class='line'>    <span class="n">spec</span> <span class="o">=</span> <span class="no">Pod</span><span class="o">::</span><span class="no">Specification</span><span class="o">.</span><span class="n">from_file</span> <span class="n">podspec_path</span>
</span><span class='line'>    <span class="n">s</span><span class="o">.</span><span class="n">dependency</span> <span class="n">spec</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="n">spec</span><span class="o">.</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>This Podspec is probably more complex then you're used to, but it means less config. To validate the Podspec, use
<code>$ pod ipc spec GitDawg.podspec</code> and read the JSON it outputs. With the Podspec set up, it's time to set up the
example project's <code>Gemfile</code> and <code>Podfile</code>.</p>

<p>We'll start with applying the <a href="https://github.com/orta/cocoapods-fix-react-native#readme">React Native hot-fix plugin</a>, sometimes a version of React Native is released
that doesn't support Swift frameworks (as Facebook doesn't use Swift) and so you have to apply some patches to the
code. I made a CocoaPods Plugin that handles the hot-fixes for you.</p>

<p>Start by making a <code>Gemfile</code> in the <code>Example</code> folder: <code>touch Example/Gemfile</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">source</span> <span class="s1">&#39;https://rubygems.org&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;cocoapods&#39;</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;cocoapods-fix-react-native&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then run <code>$ bundle install</code> in the <code>Example</code> folder, which will set up the ruby dependencies of <code>cocoapods</code> and
<code>cocoapods-fix-react-native</code> for your app. This makes it possible to reference <code>"cocoapods-fix-react-native"</code> in
your <code>Podfile</code> next.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span><span class="nb">cd </span>Example
</span><span class='line'><span class="nv">$ </span>bundle install
</span></code></pre></td></tr></table></div></figure>


<p>We want to take the current <code>Podfile</code> and make sure that every React Native dependency comes from the folder
<code>node_modules/react-native</code>. We can do this using the <code>:path</code> operator to redeclare where you can find each Pod.</p>

<p>Note: we also <em>extend</em> the amount of subspecs for <code>'React'</code> in this Podfile via <code>subspecs: ['DevSupport']</code> - this
subspec is what provide the hot code reloading and other developer tools. You'll want this, in here, it will mean
that the example app can be used as a dev environment, and your main app will only get a production environment.</p>

<p>So edit <code>Example/Podfile</code> to look like this:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">platform</span> <span class="ss">:ios</span><span class="p">,</span> <span class="s1">&#39;9.0&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">node_modules_path</span> <span class="o">=</span> <span class="s1">&#39;../node_modules&#39;</span>
</span><span class='line'><span class="n">react_path</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">node_modules_path</span><span class="p">,</span> <span class="s1">&#39;react-native&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">yoga_path</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">react_path</span><span class="p">,</span> <span class="s1">&#39;ReactCommon/yoga&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">folly_spec_path</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">react_path</span><span class="p">,</span> <span class="s1">&#39;third-party-podspecs/Folly.podspec&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">glog_spec_path</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">react_path</span><span class="p">,</span> <span class="s1">&#39;third-party-podspecs/glog.podspec&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">double_conversion_spec_path</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">react_path</span><span class="p">,</span> <span class="s1">&#39;third-party-podspecs/DoubleConversion.podspec&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">plugin</span> <span class="s1">&#39;cocoapods-fix-react-native&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">target</span> <span class="s1">&#39;GitDawg_Example&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">pod</span> <span class="s1">&#39;GitDawg&#39;</span><span class="p">,</span> <span class="ss">path</span><span class="p">:</span> <span class="s1">&#39;../&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># We want extra developer support in React inside this app</span>
</span><span class='line'>  <span class="n">pod</span> <span class="s1">&#39;React&#39;</span><span class="p">,</span> <span class="ss">path</span><span class="p">:</span> <span class="n">react_path</span><span class="p">,</span> <span class="ss">subspecs</span><span class="p">:</span> <span class="o">[</span><span class="s1">&#39;DevSupport&#39;</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># We&#39;re letting CP know where it can find these Podspecs</span>
</span><span class='line'>  <span class="n">pod</span> <span class="s1">&#39;yoga&#39;</span><span class="p">,</span> <span class="ss">path</span><span class="p">:</span> <span class="n">yoga_path</span>
</span><span class='line'>  <span class="n">pod</span> <span class="s1">&#39;Folly&#39;</span><span class="p">,</span> <span class="ss">podspec</span><span class="p">:</span> <span class="n">folly_spec_path</span>
</span><span class='line'>  <span class="n">pod</span> <span class="s1">&#39;DoubleConversion&#39;</span><span class="p">,</span> <span class="ss">podspec</span><span class="p">:</span> <span class="n">double_conversion_spec_path</span>
</span><span class='line'>  <span class="n">pod</span> <span class="s1">&#39;glog&#39;</span><span class="p">,</span> <span class="ss">podspec</span><span class="p">:</span> <span class="n">glog_spec_path</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Run the following to set up the React Native dependencies for your project.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">$</span> <span class="n">bundle</span> <span class="nb">exec</span> <span class="n">pod</span> <span class="n">install</span>
</span></code></pre></td></tr></table></div></figure>


<p>We need some native code to represent our Welcome component from the React Native template. Create two new files in
<code>Pod/Classes</code>, then re-create the CocoaPods project for it by <code>pod install</code>ing again.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>touch ../Pod/Classes/GDWelcomeViewController.h ../Pod/Classes/GDWelcomeViewController.m
</span><span class='line'><span class="nv">$ </span>bundle <span class="nb">exec </span>pod install
</span><span class='line'><span class="nv">$ </span>open GitDawg.xcworkspace
</span></code></pre></td></tr></table></div></figure>


<p>We're going to make a pretty vanilla <code>UIViewController</code>, so declare it exists in the interface and then use an
<code>RCTRootView</code> as it's <code>self.view</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="cp">#import &lt;UIKit/UIKit.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="k">@interface</span> <span class="nc">GDWelcomeViewController</span> : <span class="bp">UIViewController</span>
</span><span class='line'><span class="k">@end</span>
</span></code></pre></td></tr></table></div></figure>


<p>The <code>GDWelcomeViewController</code> is going to handle the React bridging, because that is the simplest option for our
Hello World app. We'll be going back to improve this later.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="cp">#import &quot;GDWelcomeViewController.h&quot;</span>
</span><span class='line'><span class="cp">#import &lt;React/RCTRootView.h&gt;</span>
</span><span class='line'><span class="cp">#import &lt;React/RCTBridgeDelegate.h&gt;</span>
</span><span class='line'><span class="cp">#import &lt;React/RCTBridge.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Let this View Controller handle getting the URL for the JS</span>
</span><span class='line'><span class="k">@interface</span> <span class="nc">GDWelcomeViewController</span> <span class="p">()</span> <span class="o">&lt;</span><span class="n">RCTBridgeDelegate</span><span class="o">&gt;</span>
</span><span class='line'><span class="k">@end</span>
</span><span class='line'>
</span><span class='line'><span class="k">@implementation</span> <span class="nc">GDWelcomeViewController</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Set self.view on the VC to be an RCTRootView</span>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">loadView</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">RCTBridge</span> <span class="o">*</span><span class="n">bridge</span> <span class="o">=</span> <span class="p">[[</span><span class="n">RCTBridge</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithDelegate</span><span class="p">:</span><span class="nb">self</span> <span class="nl">launchOptions</span><span class="p">:</span><span class="l">@{}</span><span class="p">];</span>
</span><span class='line'>    <span class="nb">self</span><span class="p">.</span><span class="n">view</span> <span class="o">=</span> <span class="p">[[</span><span class="n">RCTRootView</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithBridge</span><span class="p">:</span><span class="n">bridge</span>
</span><span class='line'>                                         <span class="nl">moduleName</span><span class="p">:</span><span class="s">@&quot;GitDawg&quot;</span>
</span><span class='line'>                                  <span class="nl">initialProperties</span><span class="p">:</span><span class="l">@{}</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="c1">// Use our bundled JS for now</span>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="bp">NSURL</span> <span class="o">*</span><span class="p">)</span><span class="nf">sourceURLForBridge:</span><span class="p">(</span><span class="n">RCTBridge</span> <span class="o">*</span><span class="p">)</span><span class="nv">bridge</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="bp">NSBundle</span> <span class="o">*</span><span class="n">gitdawgBundle</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSBundle</span> <span class="nl">bundleForClass</span><span class="p">:</span><span class="n">GDWelcomeViewController</span><span class="p">.</span><span class="k">class</span><span class="p">];</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">[</span><span class="n">gitdawgBundle</span> <span class="nl">URLForResource</span><span class="p">:</span><span class="s">@&quot;GitDawg&quot;</span> <span class="nl">withExtension</span><span class="p">:</span><span class="s">@&quot;js&quot;</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">@end</span>
</span></code></pre></td></tr></table></div></figure>


<p>As the <code>pod lib create</code> template uses storyboards, you will need to open up the example app's storyboard and
<a href="/images/making_cp_pod/settings_welcome.png">change the initial view controller</a> to be a <code>GDWelcomeViewController</code>.
If you see a <a href="/images/making_cp_pod/not_working.png">white screen</a> on the app launches then this hasn't been done.
Run the app in the simulator, and you should get this screen:</p>

<center><img src="/images/making_cp_pod/success.png" width="50%" /></center>


<p>This is the default screen from the React Native template, and it's proof that everything has worked for our dev
app.</p>

<p>Let's take a second to re-cover what has happened to get to this point.</p>

<ol>
<li><p>We used the <code>pod lib create</code> template to make a library repo</p></li>
<li><p>We used <code>react-native init</code> to make a React Native environment, which has the settings in the root and the
source code inside <code>src</code></p></li>
<li><p>We've bundled the React Native code into our CocoaPod's asset folder</p></li>
<li><p>We set up the Podspec for GitDawg, and then the Podfile for the example project to consume it</p></li>
<li><p>We added <a href="https://github.com/orta/cocoapods-fix-react-native#readme">cocoapods-fix-react-native</a> to hot-fix the native files</p></li>
<li><p>We added a UIViewController for the default screen from <code>react-native init</code> to our CocoaPod, and ran
<code>bundle exec pod install</code> to update the example project</p></li>
<li><p>We changed the storyboard reference to point to the UIViewController from our Pod, and ran the simulator to see
our welcome screen</p></li>
</ol>


<p>This is a full run-through of how your Pod would look when integrated into your main app's codebase. At this point
you have a unique, isolated app which is going to be your development environment. In our case this app is a menu of
different root screens and admin flags.</p>

<p>—</p>

<p>OK, let’s go take this and migrate it into GitHawk. This is our end-goal:</p>

<center><img src="/images/making_cp_pod/githawk.gif" width="75%" /></center>


<p>Our setup is going to be different here because we can't rely on React Native coming from the file-system, as we
want to make sure our app has no hint of JS tooling. So we will use CocoaPods to handle downloading and setting up
our versions of the React Native libraries. As of 0.54.x, that is React and Yoga.</p>

<p>We want to have a local copy of the JSON version of Podspecs for each of these. They can be generated from the
Podspecs using <code>bundle exec pod ipc spec [file.podspec]</code>. Let's generate one for React:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span><span class="nb">cd </span>GitDawg/node_modules/react-native/<span class="p">;</span> pod ipc spec React.podspec
</span></code></pre></td></tr></table></div></figure>


<p>It will output a bunch of JSON to your terminal. This is perfect. Let's move that text to a file on your desktop.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>pod ipc spec React.podspec &gt; ~/Desktop/React.podspec.json
</span></code></pre></td></tr></table></div></figure>




<!--

You'll see no output if everything went fine. Before you grab that podspec, let's get the one for yoga too.

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span><span class="nb">cd </span>ReactCommon/yoga/<span class="p">;</span> pod ipc spec yoga.podspec &gt; ~/Desktop/yoga.podspec.json
</span></code></pre></td></tr></table></div></figure>

-->


<p>For the yoga podspec, you should just grab our version, it's not worth me explaining all the details why, other than
the PR I made to fix a bug isn't shipped in 0.54 so run:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>curl https://raw.githubusercontent.com/artsy/emission/v1.5.0/externals/yoga/yoga.podspec.json &gt; ~/Desktop/yoga.podspec.json
</span></code></pre></td></tr></table></div></figure>


<p>You should now have two JSON files in your Desktop. Grab them, move them into the <code>Local Pods</code> folder inside
GitHawk. It should already have a few Podspecs.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span><span class="nb">cd</span> ../../../ <span class="c"># Or however it takes to get back to the project root</span>
</span><span class='line'>
</span><span class='line'><span class="c"># Move any podspec.json into the Local Pods folder</span>
</span><span class='line'><span class="nv">$ </span>mv ~/Desktop/*.podspec.json <span class="s2">&quot;Local Pods&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Modify their <code>Gemfile</code> to include <a href="https://github.com/orta/cocoapods-fix-react-native#readme">cocoapods-fix-react-native</a>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'>source &#39;https://rubygems.org&#39;
</span><span class='line'>
</span><span class='line'>gem &#39;cocoapods&#39;, &#39;~&gt; 1.4.0&#39;
</span><span class='line'><span class="gi">+ gem &#39;cocoapods-fix-react-native&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then run <code>bundle install</code>. Next we need to add GitDawg, and our custom Podspecs to the Podfile:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'>source &#39;https://github.com/CocoaPods/Specs.git&#39;
</span><span class='line'>
</span><span class='line'># Local Pods w/ custom changes
</span><span class='line'>pod &#39;SwipeCellKit&#39;, :path =&gt; &#39;Local Pods/SwipeCellKit&#39;
</span><span class='line'>pod &#39;GitHubAPI&#39;, :path =&gt; &#39;Local Pods/GitHubAPI&#39;
</span><span class='line'>pod &#39;GitHubSession&#39;, :path =&gt; &#39;Local Pods/GitHubSession&#39;
</span><span class='line'>
</span><span class='line'><span class="gi">+ # React Native Support</span>
</span><span class='line'><span class="gi">+ plugin &#39;cocoapods-fix-react-native&#39;</span>
</span><span class='line'><span class="gi">+ pod &#39;GitDawg&#39;, :path =&gt; &#39;../GitDawg&#39;</span>
</span><span class='line'><span class="gi">+ pod &#39;React&#39;, :podspec =&gt; &#39;Local Pods/React.podspec.json&#39;</span>
</span><span class='line'><span class="gi">+ pod &#39;yoga&#39;,  :podspec =&gt; &#39;Local Pods/yoga.podspec.json&#39;</span>
</span><span class='line'>
</span><span class='line'>target &#39;Freetime&#39; do
</span></code></pre></td></tr></table></div></figure>


<p>Then run <code>$ bundle exec pod install</code>. That should grab React Native for you. Unlike inside GitDawg, CocoaPods will
download the source code from the internet. <code>:podspec</code> only tells CocoaPods where to find the Podspec, but it will
still download code externally.</p>

<p>Open up the Xcode Workspace - <code>open Freetime.xcworkspace</code>, and we're gonna make the code changes - it's all in one
file. Open the file <code>RootNavigationManager.swift</code> (it's in <code>Classes/Systems</code>) and add a new <code>import</code> at the top for
<code>GitDawg</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'>import UIKit
</span><span class='line'>import GitHubAPI
</span><span class='line'>import GitHubSession
</span><span class='line'><span class="gi">+ import GitDawg</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then add our new view controller by replacing the bookmarks view controller on line 78.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'>    tabBarController?.viewControllers = [
</span><span class='line'>        newNotificationsRootViewController(client: client),
</span><span class='line'>        newSearchRootViewController(client: client),
</span><span class='line'><span class="gi">+            GDWelcomeViewController(),</span>
</span><span class='line'><span class="gd">-            newBookmarksRootViewController(client: client),</span>
</span><span class='line'>        settingsRootViewController ?? UIViewController() // simply satisfying compiler
</span><span class='line'>    ]
</span></code></pre></td></tr></table></div></figure>


<p>That should get you to the same point as we were in the dev app. Now when you run the app, log in and hit the place
where the bookmarks icon used to live. Tada.</p>

<p>So what did we do? First, we added GitDawg, React and Yoga as dependencies in GitHawk's Podfile to get them
installed. Then we switched to using GitDawg's native view controller in 2 lines of code. No JavaScript in GitHawk,
little faffing overall.</p>

<p>This is how all our view controllers are exposed and used in production.</p>

<a name="What.now."></a>
<h2>What now?</h2>

<p>We've now got a successful deploy of our React Native Pod into an external app. However, we need to make some
changes in GitDawg now to start making it possible to develop efficiently.</p>

<p>We will need to:</p>

<ol>
<li><p>Make a singleton to handle setting up React Native between all potential UIViewControllers</p></li>
<li><p>Use the React Native Packager to get runtime editing support</p></li>
</ol>


<p>Move your terminal back to the GitDawg folder. We're going to make a class that represents our library, GitDawg</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>touch Pod/Classes/GitDawg.h Pod/Classes/GitDawg.m
</span></code></pre></td></tr></table></div></figure>


<p>Then we need to re-run <code>$ bundle exec pod install</code> in the <code>Example</code> folder to get it in Xcode. Open up the Xcode
workspace for GitDawg and let's fill in these files. These files are based on <a href="https://github.com/artsy/emission/blob/master/Pod/Classes/Core/AREmission.h">AREmission.h</a> and
<a href="https://github.com/artsy/emission/blob/master/Pod/Classes/Core/AREmission.m">AREmission.m</a>. For us, in a production app, <code>AREmission</code> has a few key responsibilities:</p>

<ol>
<li><p>Pass through the non-optional environment variables to expose in JS</p></li>
<li><p>Create and retain the React Native bridge</p></li>
<li><p>Set up the native modules so that we React Native can communicate with the host app</p></li>
</ol>


<p>For this tutorial we don't need all of these responsibilities, but we will handle the second one.</p>

<p>For the header file, <code>GitDawg.h</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="cp">#import &lt;Foundation/Foundation.h&gt;</span>
</span><span class='line'><span class="cp">#import &lt;React/RCTBridge.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="n">NS_ASSUME_NONNULL_BEGIN</span>
</span><span class='line'>
</span><span class='line'><span class="c1">/// The RN library API</span>
</span><span class='line'><span class="k">@interface</span> <span class="nc">GitDawg</span> : <span class="bp">NSObject</span>
</span><span class='line'>
</span><span class='line'><span class="c1">/// The way in which we communicate with React Native</span>
</span><span class='line'><span class="k">@property</span> <span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">strong</span><span class="p">,</span> <span class="k">readonly</span><span class="p">)</span> <span class="n">RCTBridge</span> <span class="o">*</span><span class="n">bridge</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">/// The single instance of a GitDawg</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">sharedInstance</span><span class="p">;</span>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setSharedInstance:</span><span class="p">(</span><span class="n">GitDawg</span> <span class="o">*</span><span class="p">)</span><span class="nv">instance</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">/// Pass in nil for a packagerURL to indicate this is in release mode</span>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">initWithPackagerURL:</span><span class="p">(</span><span class="n">nullable</span> <span class="bp">NSURL</span> <span class="o">*</span><span class="p">)</span><span class="nv">packagerURL</span> <span class="n">NS_DESIGNATED_INITIALIZER</span><span class="p">;</span>
</span><span class='line'><span class="p">-</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nf">init</span> <span class="n">NS_UNAVAILABLE</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">@end</span>
</span><span class='line'>
</span><span class='line'><span class="n">NS_ASSUME_NONNULL_END</span>
</span></code></pre></td></tr></table></div></figure>


<p>And for the implementation file <code>GitDawg.m</code>:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'><span class="cp">#import &quot;GitDawg.h&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">@interface</span> <span class="nc">GitDawg</span><span class="p">()</span> <span class="o">&lt;</span><span class="n">RCTBridgeDelegate</span><span class="o">&gt;</span>
</span><span class='line'><span class="k">@property</span> <span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">copy</span><span class="p">)</span> <span class="bp">NSURL</span> <span class="o">*</span><span class="n">packagerURL</span><span class="p">;</span>
</span><span class='line'><span class="k">@end</span>
</span><span class='line'>
</span><span class='line'><span class="k">@implementation</span> <span class="nc">GitDawg</span>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="n">GitDawg</span> <span class="o">*</span><span class="n">_sharedInstance</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="p">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">setSharedInstance:</span><span class="p">(</span><span class="n">GitDawg</span> <span class="o">*</span><span class="p">)</span><span class="nv">instance</span><span class="p">;</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">_sharedInstance</span> <span class="o">=</span> <span class="n">instance</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="o">+</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="n">sharedInstance</span><span class="p">;</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="n">NSParameterAssert</span><span class="p">(</span><span class="n">_sharedInstance</span><span class="p">);</span>
</span><span class='line'>    <span class="k">return</span> <span class="n">_sharedInstance</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="kt">instancetype</span><span class="p">)</span><span class="nl">initWithPackagerURL</span><span class="p">:(</span><span class="bp">NSURL</span> <span class="o">*</span><span class="p">)</span><span class="n">packagerURL</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="nb">self</span> <span class="o">=</span> <span class="p">[</span><span class="nb">super</span> <span class="n">init</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">_packagerURL</span> <span class="o">=</span> <span class="n">packagerURL</span><span class="p">;</span>
</span><span class='line'>    <span class="n">_bridge</span> <span class="o">=</span> <span class="p">[[</span><span class="n">RCTBridge</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithDelegate</span><span class="p">:</span><span class="nb">self</span> <span class="nl">launchOptions</span><span class="p">:</span><span class="l">@{}</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="nb">self</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="bp">NSURL</span> <span class="o">*</span><span class="p">)</span><span class="nl">sourceURLForBridge</span><span class="p">:(</span><span class="n">RCTBridge</span> <span class="o">*</span><span class="p">)</span><span class="n">bridge</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">self</span><span class="p">.</span><span class="n">packagerURL</span> <span class="o">?:</span> <span class="nb">self</span><span class="p">.</span><span class="n">releaseBundleURL</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="o">-</span> <span class="p">(</span><span class="bp">NSURL</span> <span class="o">*</span><span class="p">)</span><span class="n">releaseBundleURL</span><span class="p">;</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="p">[[</span><span class="bp">NSBundle</span> <span class="nl">bundleForClass</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="k">class</span><span class="p">]</span> <span class="nl">URLForResource</span><span class="p">:</span><span class="s">@&quot;GitDawg&quot;</span> <span class="nl">withExtension</span><span class="p">:</span><span class="s">@&quot;js&quot;</span><span class="p">];</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">@end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Then change your <code>GDWelcomeViewController.m</code> to use the shared <code>GitDawg</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'> #import &quot;GDWelcomeViewController.h&quot;
</span><span class='line'><span class="gi">+#import &quot;GitDawg.h&quot;</span>
</span><span class='line'> #import &lt;React/RCTRootView.h&gt;
</span><span class='line'><span class="gd">-#import &lt;React/RCTBridgeDelegate.h&gt;</span>
</span><span class='line'><span class="gd">-#import &lt;React/RCTBridge.h&gt;</span>
</span><span class='line'>
</span><span class='line'> - (void)loadView
</span><span class='line'> {
</span><span class='line'><span class="gd">-    RCTBridge *bridge = [[RCTBridge alloc] initWithDelegate:self launchOptions:@{}];</span>
</span><span class='line'><span class="gi">+    RCTBridge *bridge = [GitDawg sharedInstance].bridge;</span>
</span><span class='line'>     self.view = [[RCTRootView alloc] initWithBridge:bridge
</span><span class='line'>                                              moduleName:@&quot;GitDawg&quot;
</span><span class='line'>                                     initialProperties:@{}];
</span><span class='line'> }
</span><span class='line'>
</span><span class='line'><span class="gd">-// Just use our packaged JS for now</span>
</span><span class='line'><span class="gd">-- (NSURL *)sourceURLForBridge:(RCTBridge *)bridge</span>
</span><span class='line'><span class="gd">-{</span>
</span><span class='line'><span class="gd">-    NSBundle *emissionBundle = [NSBundle bundleForClass:GDWelcomeViewController.class];</span>
</span><span class='line'><span class="gd">-    return [emissionBundle URLForResource:@&quot;GitDawg&quot; withExtension:@&quot;js&quot;];</span>
</span><span class='line'><span class="gd">-}</span>
</span><span class='line'><span class="gd">-</span>
</span><span class='line'> @end
</span></code></pre></td></tr></table></div></figure>


<p>We use the UIAppDelegate callback to set up our React Native bridge (you want this ready as fast as possible
normally) so edit <code>Example/GitDawg/GDAppDelegate.m</code></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='diff'><span class='line'> #import &quot;GDAppDelegate.h&quot;
</span><span class='line'><span class="gi">+#import &lt;GitDawg/GitDawg.h&gt;</span>
</span><span class='line'>
</span><span class='line'> @implementation GDAppDelegate
</span><span class='line'>
</span><span class='line'> - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
</span><span class='line'> {
</span><span class='line'><span class="gd">-    // Override point for customization after application launch.</span>
</span><span class='line'><span class="gi">+    NSURL *packagerURL = [NSURL URLWithString:@&quot;http://localhost:8081/src/index.bundle?platform=ios&quot;];</span>
</span><span class='line'><span class="gi">+    GitDawg *dawg = [[GitDawg alloc] initWithPackagerURL:packagerURL];</span>
</span><span class='line'><span class="gi">+    [GitDawg setSharedInstance:dawg];</span>
</span><span class='line'><span class="gi">+</span>
</span><span class='line'>     return YES;
</span><span class='line'> }
</span></code></pre></td></tr></table></div></figure>


<p>These changes give you the ability to switch between a dev mode and a release mode. Consider that React Native just
runs your JavaScript, the source of that could be anything, including from a local dev server. Well, almost.</p>

<p>Because of Apple's HTTP security, you cannot connect to localhost in an app by default. To fix this, open up
<code>GitDawg-info.plist</code> and right-click to add a new row. Paste in <code>NSAppTransportSecurity</code> as the name, and Xcode will
switch it to "App Transport Security Settings". Hit the <code>+</code> and add "Allow arbitrary loads" then set it to true.</p>

<p>From here: run the GitDawg app and you should see a red screen. This will be telling you to start the React Native
Packager. Let's do that. From the root of the GitDwag repo run <code>$ yarn start</code>. This will start up a server. Once it
says "Metro Bundler Ready." you can go back into your simulator for GitDawg and hit the reload button at the bottom.</p>

<p>That's it.</p>

<p>We're done.</p>

<p>So, there's obviously a lot more to learn here. You've successfully set up a Pod that you can deploy to an app. To
make a real version you'd need to do a bit more process like creating a repo, and making tags.</p>

<p>We use our root view controller in Emission to trigger loading any of our view controllers, in different states. We
also mix that with some admin options, the ability to run someone's PRs and <a href="https://storybook.js.org">storybooks</a>.</p>

<center><img src="/images/making_cp_pod/emission.png" width="100%" /></center>


<p>So good luck! Something like this probably easily scripted, but there's a lot of value in understanding how every
piece comes together. So let me know if you make something cool - we've been using this structure for 2 years now
and I think it's the right way to integrate React Native into an existing complex app. It keeps your JS tooling in a
completely different repo from your iOS tooling.</p>

        </article>

        <article class='post'>
          <p style="padding-bottom: 0; margin-bottom:0;">
            <a href="https://www.artsy.net/" style="background-image: none;">
              <svg viewBox="0 0 510 510" width="40" height="40" xmlns="http://www.w3.org/2000/svg">
                <path transform="scale(1, -1) translate(0, -480)" d="M0 -32h512v512h-512v-512v0zM464 16h-80v80h-48v-80h-288v416h416v-416v0zM194 384h-40l-74 -186h38l20 52h72l19 -52h39l-74 186v0zM149 282l25 66l24 -66h-49v0z"></path>
              </svg>
            </a>
          <p/>
        </article>

      
        <article class='post'>
          <section id="comments" />

<script type="text/javascript">
  // Comes from https://stackoverflow.com/questions/3177836/how-to-format-time-since-xxx-e-g-4-minutes-ago-similar-to-stack-exchange-site
  function timeSince(date) {
    var seconds = Math.floor((new Date() - date) / 1000)
    var interval = Math.floor(seconds / 31536000)

    if (interval > 1) {
      return interval + " years"
    }
    interval = Math.floor(seconds / 2592000)
    if (interval > 1) {
      return interval + " months"
    }
    interval = Math.floor(seconds / 86400)
    if (interval > 1) {
      return interval + " days"
    }
    interval = Math.floor(seconds / 3600)
    if (interval > 1) {
      return interval + " hours"
    }
    interval = Math.floor(seconds / 60)
    if (interval > 1) {
      return interval + " minutes"
    }
    return Math.floor(seconds) + " seconds"
  }

  var writeToComment = function (element, html) {
    var element = document.createElement(element)
    element.innerHTML = html
    document.getElementById("comments").appendChild(element)
  }

  var addReactions = function (reactions, link) {
    var returnString = ""
    var emojiCode = {
      '+1': "<g-emoji alias='+1' fallback-src='https://assets-cdn.github.com/images/icons/emoji/unicode/1f44d.png' class='emoji'>👍</g-emoji>",
      '-1': "<g-emoji alias='-1' fallback-src='https://assets-cdn.github.com/images/icons/emoji/unicode/1f44e.png' class='emoji'>👎</g-emoji>",
      laugh: "<g-emoji alias='smile' fallback-src='https://assets-cdn.github.com/images/icons/emoji/unicode/1f604.png' class='emoji'>😄</g-emoji>",
      hooray: "<g-emoji alias='tada' fallback-src='https://assets-cdn.github.com/images/icons/emoji/unicode/1f389.png' class='emoji'>🎉</g-emoji>",
      confused: "<g-emoji alias='thinking_face' fallback-src='https://assets-cdn.github.com/images/icons/emoji/unicode/1f615.png' class='emoji'>😕</g-emoji>",
      heart: "<g-emoji alias='framed_picture' fallback-src='https://assets-cdn.github.com/images/icons/emoji/unicode/1f5bc.png' class='emoji'>🖼</g-emoji>"
    }

    if (reactions.total_count > 0) {
      returnString += "<div class='comment-reactions'>"
      for (var key in reactions) {
        if (reactions.hasOwnProperty(key)) {
          if (reactions[key] > 0 && key !== "total_count") {
            returnString += "<a href='" + link + "' class='emoji-wrapper'>" + emojiCode[key] + reactions[key] + "</a>"
          }
        }
      }
      returnString += "</div>"
      return returnString
    } else {
      return "<div></div>"
    }
  }

  // Based on http://ivanzuzak.info/2011/02/18/github-hosted-comments-for-github-hosted-blogs.html
  // And http://donw.io/post/github-comments/

  var loadComments = function (data) {
    writeToComment("h2", "Comments")
    for (var i = 0; i < data.length; i++) {
      var cuser = data[i].user.login
      var cuserlink = data[i].user.html_url
      var clink = data[i].html_url
      var cbody = data[i].body_html
      var cavatarlink = data[i].user.avatar_url
      var cdate = new Date(data[i].created_at)
      var creactions = addReactions(data[i].reactions, clink)

      var commentHTML =
        "<div class='comment'>" +
        "<div class='comment-header'>" +
        "<a class='comment-username' href=\"" + cuserlink + '">' +
        '<img src="' + cavatarlink + '" alt="" width="40" height="40">' +
        cuser +
        "</a>" + " commented " +
        "<a class='comment-date' href=\"" + clink + '">' +
        timeSince(cdate) + " ago" +
        "</a>" +
        "</div>" +
        "<div class='comment-body'>"
        + cbody +
        "</div>" +
        creactions +
        "</div>"
      writeToComment("div", commentHTML)
    }

    var callToAction =
      "<hr/>" +
      "<p>" +
      "Our comments are using GitHub Issues on the Artsy Blog repo. You can post by replying to <a href='https://github.com/artsy/artsy.github.io/issues/430'>issue #430</a>." +
      "</p>"
    writeToComment("div", callToAction)
  }

  var writeFirstComment = function () {
    var callToAction =
      "<hr/>" +
      "<p>" +
      "This post has no comments, yet, you could be the first. Our comments are using GitHub Issues on the Artsy Blog repo. You can post by replying to <a href='https://github.com/artsy/artsy.github.io/issues/430'>issue #430</a>." +
      "</p>"
    writeToComment("div", callToAction)
  }

  if (window.fetch) {
    var url =
      "https://artsy-blog-gh-commentify.herokuapp.com/repos/artsy/artsy.github.io/issues/430/comments"
    window
      .fetch(url, { Accept: "application/vnd.github.v3.html+json" })
      .then(function (response) {
        return response.json()
      })
      .then(function (json) {
        if (json.length) {
          loadComments(json)
        } else {
          writeFirstComment()
        }
      })
  }

</script>
        </article>
      

      </section>

      <footer>
        <article>

          <section>
            <h4>Author</h4>
            <p> <a href="/author/orta"/>Orta Therox</a></p>
            <p>Code Janitor at Artsy, thinking about JS tooling.</a></p>
          </section>

          <section>
            <h4>Post Meta</h4>
            <p>Apr 17, 2018</p>
            <p>Tagged: <a class='category' href='/blog/categories/emission/'>emission</a>, <a class='category' href='/blog/categories/javascript/'>javascript</a>, <a class='category' href='/blog/categories/react/'>react</a>, <a class='category' href='/blog/categories/reaction/'>reaction</a>, <a class='category' href='/blog/categories/reactnative/'>reactnative</a>, <a class='category' href='/blog/categories/technology/'>technology</a></p>
          </section>
          <br/>
          <section>
            <h4>Artsy OSS</h4>
            <ul>
              <li><a href='https://www.artsy.net'>Artsy.net</a></li>
              <li><a href='https://developers.artsy.net'>API</a></li>
              <li><a href='http://artsy.github.io/open-source/'>Featured OSS</a></li>
              <li><a href='https://www.artsy.net/jobs'>Careers</a></li>
            </ul>
          </section>

          <section>
            <h4>Blog</h4>
            <ul>
              <li><a href='http://artsy.github.io/blog/archives/'>Archives</a></li>
              <li><a href='http://artsy.github.io/search/'>Search</a></li>
              <li><a href='https://github.com/artsy/artsy.github.io'>Code on GitHub</a></li>
              <li><a href='https://github.com/artsy/artsy.github.io/edit/source/_posts/2018-04-17-making-a-components-pod.markdown'>Fix typoes in this post</a></li>
            </ul>
          </section>

        </article>

        <article>
          <section>
            <h4>Post Series on the Blog</h4>
            <ul>
              
              <li><a href='/series/react-native-at-artsy/'>React Native at Artsy</a></li>
              
              <li><a href='/series/javascriptures/'>JavaScriptures</a></li>
              
              <li><a href='/series/stages-of-professional-growth/'>Stages of Professional Growth</a></li>
              
              <li><a href='/series/artsy-tech-stack/'>Artsy Tech Stack</a></li>
              
              <li><a href='/series/open-source-by-default/'>Open Source by Default</a></li>
              
            </ul>
          </section>

          <section>
          
          <p class="meta-series" style="padding-bottom:0;">More from <strong><a class='series' href='/series/react-native-at-artsy/'>React Native at Artsy</a></strong></p>
          <ul>
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                
                <li><a href='/blog/2018/06/03/Announcing-Artsy-x-React-Native/'>Announcing: Artsy x React Native</a></li>
                  
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                  
              
            
              
            
              
                
                <li><a href='/blog/2018/03/17/two-years-of-react-native/'>React Native, 2 years later</a></li>
                  
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                
                <li><a href='/blog/2017/07/06/React-Native-for-iOS-devs/'>Intro to React Native for an iOS Developer</a></li>
                  
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                
                <li><a href='/blog/2017/02/05/Retrospective-Swift-at-Artsy/'>Retrospective: Swift at Artsy</a></li>
                  
              
            
              
                
                <li><a href='/blog/2017/02/05/Front-end-JavaScript-at-Artsy-2017/'>Exploration: Front-end JavaScript at Artsy in 2017</a></li>
                  
              
            
              
            
              
            
              
            
              
            
              
            
              
                
                <li><a href='/blog/2016/11/14/JS-Glossary/'>JavaScript Glossary for 2017</a></li>
                  
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                
                <li><a href='/blog/2016/08/24/On-Emission/'>On our implementation of React Native</a></li>
                  
              
            
              
            
              
                
                <li><a href='/blog/2016/08/15/vscode/'>Using VS Code for JavaScript</a></li>
                  
              
            
              
            
              
                
                <li><a href='/blog/2016/08/15/React-Native-at-Artsy/'>React Native at Artsy</a></li>
                  
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
                
                <li><a href='/blog/2016/06/19/graphql-for-mobile/'>GraphQL for iOS Developers</a></li>
                  
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
              
            
          </ul>
          
          </section>
        </article>

      </footer>
    </div>
  </div>
</body>
