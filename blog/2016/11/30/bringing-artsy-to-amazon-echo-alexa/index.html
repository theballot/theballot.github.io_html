
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Bringing Artsy to Amazon Echo "Alexa" - Artsy Engineering</title>
  <meta name="author" content="">

  
  <meta name="description" content="
  

    



  
    
      
        
          
        
        
          Bringing Artsy to Amazon Echo "Alexa"
        
          
  



  

  
...">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:image" content="http://artsy.github.io/images/artsy_oss_image.png" />
  <meta property="og:image:type" content="image/png" />

  
  <link rel="canonical" href="http://artsy.github.io/blog/2016/11/30/bringing-artsy-to-amazon-echo-alexa/">
  <link rel="alternate" type="application/rss+xml" title="Artsy Engineering Blog" href="/feed">

  <link href="/favicon.ico" rel="icon">
  <link href="/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">

  <script src="/javascripts/jquery-1.11.3.min.js"> </script>
  <script src="/javascripts/gradient-fade.js"></script>
  <script src="/javascripts/noframework.waypoints.min.js"></script>
  <script src="/javascripts/sticky.min.js"></script>
  <script src="/javascripts/search.min.js"></script>

  

  <script type="text/javascript" src="https://fast.fonts.net/jsapi/f7f47a40-b25b-44ee-9f9c-cfdfc8bb2741.js"></script>


  <link href="" rel="alternate" title="Artsy Engineering" type="application/atom+xml">
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-12450662-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  <!--[if IE 8]><link href="/stylesheets/custom/ie_font.css" type="text/css"><![endif]-->

</head>


<body>
  <div id="logo-container">
    <a id="lrg-mark" href="https://www.artsy.net/">
      <svg viewBox="0 0 510 510" width="40" height="40" xmlns="http://www.w3.org/2000/svg">
        <path transform="scale(1, -1) translate(0, -480)" d="M0 -32h512v512h-512v-512v0zM464 16h-80v80h-48v-80h-288v416h416v-416v0zM194 384h-40l-74 -186h38l20 52h72l19 -52h39l-74 186v0zM149 282l25 66l24 -66h-49v0z"/>
      </svg>
    </a>
  </div>
  <header id="banner"><div id="header">
  <div class="header-navigation">
    <ul>
      <li><a href="https://developers.artsy.net/">API</a></li>
      <li><a href="https://www.artsy.net/jobs">Careers</a></li>
      <li><a href="http://twitter.com/artsyopensource">@artsyopensource</a></li>
      <li><a href="http://www.artsy.net/">Artsy.net</a></li>
    </ul>
    <span class="header-section-title">
      
        <a href="/open-source">Open Source</a>
      
    </span>
  </div>

  <div class="header-sticky-container">
    <div class="header-logo">
      <h2><a href="http://artsy.github.io">Artsy</a></h2>
    </div>
    <div class="header-search">
      
        <h2><a href="/">Engineering Blog</a></h2>
        <span>
  <form action="/search" method="get">
    <input class="search" id="search-query" type="text" name="q" results="0" placeholder="Search"/>
  </form>

</span>
      
    </div>
  </div>
</div>
</header>
  <div class="header-hamburger">
    <button class="cmn-toggle-switch cmn-toggle-switch__htx">
      <span>toggle menu</span>
    </button>
  </div>
  <div id="main">
    <div id="content">

      <div>
  <article class="hentry" role="article">

    
<div class="article-container-single ">


  
    <div class="meta-container">
      <header>
        
          <a href="">
        
        
          <h2 class="entry-title">Bringing Artsy to Amazon Echo "Alexa"</h2>
        
          <p class="meta-author">
  



  

  
    <div class="meta">
      <span class="byline author vcard"><a href ="/author/db">Daniel Doubrovkine<a/></span>
      
      <p class="fn">
        <a href="https://twitter.com/dblockdotorg">@dblockdotorg</a>
      </p>
      

    </div>
  

</p>
          </a>
      </header>
    </div>
  

  <div class="content-container">
    
      <div class="entry-content"><p>tl;dr You can try Artsy on your Amazon Echo now, say "Alexa, enable Artsy" or see <a href="http://alexa.artsy.net">alexa.artsy.net</a> for more info.</p>

<p>With its powerful automatic speech recognizer, accurate natural language understanding and outstanding text-to-speech capabilities, the Amazon Echo, nicknamed "Alexa", always impressed me. While not the first in its category and introduced in late 2014, Alexa was the first consumer device in my home to truly enable the conversation between human and machine. It was stationary, always listening for a wake word, and clearly outperformed all previous attempts when it came to the ability to receive commands from the other side of the apartment.</p>

<p>Alexa knows about the weather, but it doesn't know much about art.</p>

<p>In this post I'll dig a little inside the Alexa software platform and go over the technical details of bringing Artsy to the Echo, starting with a very simple "Ask Artsy about Norman Rockwell."</p>

<p><a href='https://www.youtube.com/watch?v=zi3OubNiV9U' target='_blank'></p>

<iframe width="280" height="280" src="https://www.youtube.com/embed/zi3OubNiV9U" frameborder="0" allowfullscreen></iframe>


<p></a></p>

<p>Find the <a href="http://alexa.amazon.com/spa/index.html#skills/dp/B01MYLJO1N">Artsy skill in the Alexa app</a> and <a href="https://github.com/artsy/elderfield">the complete Skill code on Github</a>. And if you just want to learn to write a skill quickly, watch <a href="https://www.youtube.com/watch?v=pzM4jv7k7Rg">@dblock live-code a skill in this video</a>.</p>

<!-- more -->


<a name="How.does.Alexa.work."></a>
<h3>How does Alexa work?</h3>

<p><em>Alexa</em> is the software platform used by Alexa-enabled devices such as the <em>Amazon Echo</em> or the <em>Echo Dot</em>. I used a $49.- Dot with headphones for most testing, and I have a bigger Echo at home (the main difference is the quality of the speaker). Because even a smaller Dot was sufficiently annoying to my coworkers, I wish it were battery powered, so I wouldn't need to unplug it to go run tests in a conference room.</p>

<p>Alexa waits for a <em>wake word</em>, either "Alexa" or "Amazon". It's always on and has a built-in speech recognizer for the wake word only. After it hears the wake word, a blue light ring turns on and the device starts transmitting the user's voice, called an <em>utterance</em> to the Alexa platform in the cloud. The light ring is the indicator of it "listening". The cloud service will translate speech to text and run it through a natural language system to identify an <em>intent</em>, such as "ask Artsy about". The intent is sent to a <em>skill</em>, which is a piece of software living in the cloud that can generate a <em>directive</em> to "speak" along with markup in <a href="https://www.w3.org/TR/speech-synthesis">SSML</a> format, transformed into voice and finally sent in wave format back to the device to be played back to the user.</p>

<a name="Developer.Prerequisites"></a>
<h3>Developer Prerequisites</h3>

<p>You need an <a href="https://developer.amazon.com">Amazon Apps and Services Developer account</a> and access to <a href="https://console.aws.amazon.com/lambda">AWS Lambda</a>. I've implemented the Artsy skill in node.js using <a href="https://github.com/matt-kruse/alexa-app">alexa-app</a>. You can find the <a href="https://github.com/artsy/elderfield">complete Skill code on Github</a>.</p>

<a name="Designing.an.Intent"></a>
<h3>Designing an Intent</h3>

<p>To get Alexa to listen, you must design an intent. Each intent is identified by a <em>name</em> and a set of <em>slots</em>. This is an order of magnitude more limited than what the Alexa system is capable of doing out of the box. It means that the platform <em>will not</em> transcribe any text for your application, chatbot-style. The intents have to be simple and clear and use English language words or predefined vocabularies. Furthermore, Alexa has a lot of trouble with names as it constantly attempts to recognize them as dictionary words and no support for "wildcards".</p>

<p>I started implementing a fairly complicated "when is an artist born" intent, which turned to be too ambitious for Alexa to understand and ended up with a much simpler "ask artsy about an artist". I called this "AboutIntent", which takes an artist name as input (or slot).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span>
</span><span class='line'>   <span class="nt">&quot;intents&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span class='line'>      <span class="p">{</span>
</span><span class='line'>         <span class="nt">&quot;intent&quot;</span><span class="p">:</span> <span class="s2">&quot;AboutIntent&quot;</span><span class="p">,</span>
</span><span class='line'>         <span class="nt">&quot;slots&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span class='line'>            <span class="p">{</span>
</span><span class='line'>               <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;VALUE&quot;</span><span class="p">,</span>
</span><span class='line'>               <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;NAME&quot;</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>         <span class="p">]</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>   <span class="p">]</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The only possible sample utterance of this intent is "about {VALUE}", the "ask Artsy" portion is implied.</p>

<p>Since Alexa cannot understand artist names out of the box, I had to teach it with a custom, user-defined slot type added to the "Skill Interaction Model" with about a thousand most popular artist names on Artsy.</p>

<p><img src="/images/2016-11-30-bringing-artsy-to-amazon-echo-alexa/alexa-interaction-model.png" alt="Alexa interaction model" /></p>

<a name="Implementing.a.Skill"></a>
<h3>Implementing a Skill</h3>

<p>Intents are the API of a skill, otherwise known as an Alexa app. Using <a href="https://github.com/matt-kruse/alexa-app">alexa-app</a> makes implementing intents easy.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">alexa</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;alexa-app&#39;</span><span class="p">);</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">alexa</span><span class="p">.</span><span class="nx">app</span><span class="p">(</span><span class="s1">&#39;artsy&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">launch</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">res</span>
</span><span class='line'>        <span class="c1">// welcome message</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">say</span><span class="p">(</span><span class="s2">&quot;Welcome to Artsy! Ask me about an artist.&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="c1">// don&#39;t close the session, wait for user input (an artist name)</span>
</span><span class='line'>        <span class="c1">// and provide a re-prompt in case the user says something meaningless</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">shouldEndSession</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="s2">&quot;Ask me about an artist. Say help if you need help or exit any time to exit.&quot;</span><span class="p">)</span>
</span><span class='line'>        <span class="c1">// speak the response</span>
</span><span class='line'>        <span class="p">.</span><span class="nx">send</span><span class="p">();</span>
</span><span class='line'><span class="p">});</span>
</span><span class='line'>
</span><span class='line'><span class="nx">app</span><span class="p">.</span><span class="nx">intent</span><span class="p">(</span><span class="s1">&#39;AboutIntent&#39;</span><span class="p">,</span> <span class="p">{</span>
</span><span class='line'>        <span class="s2">&quot;slots&quot;</span><span class="o">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="s2">&quot;VALUE&quot;</span><span class="o">:</span> <span class="s2">&quot;NAME&quot;</span>
</span><span class='line'>        <span class="p">},</span>
</span><span class='line'>        <span class="s2">&quot;utterances&quot;</span><span class="o">:</span> <span class="p">[</span>
</span><span class='line'>            <span class="s2">&quot;about {-|VALUE}&quot;</span>
</span><span class='line'>        <span class="p">]</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// intent implementation goes here</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p>The skill expects a slot value as defined in the intent above.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">slot</span><span class="p">(</span><span class="s1">&#39;VALUE&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">res</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">say</span><span class="p">(</span><span class="s2">&quot;Sorry, I didn&#39;t get that artist name.&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="c1">// don&#39;t close the session, wait for user input again (an artist name)</span>
</span><span class='line'>    <span class="p">.</span><span class="nx">shouldEndSession</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="s2">&quot;Ask me about an artist. Say help if you need help or exit any time to exit.&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// asynchronously lookup the artist in the Artsy API, read their bio</span>
</span><span class='line'>  <span class="c1">// tell alexa-app that we&#39;re performing an asynchronous operation by returning false</span>
</span><span class='line'>  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>We use the <a href="https://developers.artsy.net">Artsy API</a> to implement the actual skill. There's not much more to it.</p>

<a name="Skill.Development.Mode"></a>
<h3>Skill Development Mode</h3>

<p>I found it convenient to host the skill inside an <a href="https://github.com/matt-kruse/alexa-app-server">alexa-app-server</a> in development. It automatically loads skills from subdirectories with the following directory structure.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="o">+---</span> <span class="nx">server</span><span class="p">.</span><span class="nx">js</span>                  <span class="c1">// the alexa-app-server host for development</span>
</span><span class='line'><span class="o">+---</span> <span class="kr">package</span><span class="p">.</span><span class="nx">json</span>               <span class="c1">// dependencies of the host</span>
</span><span class='line'><span class="o">+---</span> <span class="nx">project</span><span class="p">.</span><span class="nx">json</span>               <span class="c1">// lambda settings for deployment with apex</span>
</span><span class='line'><span class="o">+----</span><span class="nx">functions</span>                  <span class="c1">// all skills</span>
</span><span class='line'>     <span class="o">+--</span><span class="nx">artsy</span>                   <span class="c1">// the artsy skill</span>
</span><span class='line'>        <span class="o">+--</span><span class="kd">function</span><span class="p">.</span><span class="nx">json</span>        <span class="c1">// describes the skill lambda function</span>
</span><span class='line'>        <span class="o">+--</span><span class="kr">package</span><span class="p">.</span><span class="nx">json</span>         <span class="c1">// dependencies of the skill</span>
</span><span class='line'>        <span class="o">+--</span><span class="nx">index</span><span class="p">.</span><span class="nx">js</span>             <span class="c1">// skill intent implementation</span>
</span><span class='line'>        <span class="o">+--</span><span class="nx">schema</span><span class="p">.</span><span class="nx">json</span>          <span class="c1">// exported skill intent schema</span>
</span><span class='line'>        <span class="o">+--</span><span class="nx">utterances</span><span class="p">.</span><span class="nx">txt</span>       <span class="c1">// exported skill uterrances</span>
</span><span class='line'>        <span class="o">+--</span><span class="nx">node_modules</span>         <span class="c1">// modules from npm install</span>
</span><span class='line'><span class="o">+---</span> <span class="nx">node_modules</span>               <span class="c1">// modules from npm install</span>
</span></code></pre></td></tr></table></div></figure>


<p>Note that the server exports the Express.js server for testing.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">AlexaAppServer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;alexa-app-server&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">AlexaAppServer</span><span class="p">.</span><span class="nx">start</span><span class="p">({</span>
</span><span class='line'>    <span class="nx">port</span><span class="o">:</span> <span class="mi">8080</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">app_dir</span><span class="o">:</span> <span class="s2">&quot;functions&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">post</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">server</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">server</span><span class="p">.</span><span class="nx">express</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Skill.Modes"></a>
<h3>Skill Modes</h3>

<p>The skill is mounted standalone in AWS lambda, under alexa-app-sever in development and otherwise will export schema and utterances. It decides what to do based on <code>process.env['ENV']</code>, loaded from a ".env" file. The committed version of this file sets the value to "development".</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="s2">&quot;ENV&quot;</span><span class="o">:</span> <span class="s2">&quot;development&quot;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>The server loads <code>.env</code> from <code>server.js</code>.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">var</span> <span class="nx">config</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./.env.json&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">config</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finally, the skill can do different things in different environments.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">[</span><span class="s1">&#39;ENV&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;lambda&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">exports</span><span class="p">.</span><span class="nx">handle</span> <span class="o">=</span> <span class="nx">app</span><span class="p">.</span><span class="nx">lambda</span><span class="p">();</span> <span class="c1">// AWS lambda</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">[</span><span class="s1">&#39;ENV&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;development&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">app</span><span class="p">;</span> <span class="c1">// development mode</span>
</span><span class='line'><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>
</span><span class='line'>    <span class="c1">// export schema and utterances</span>
</span><span class='line'>    <span class="c1">// copy-paste the contents into the Interaction Model</span>
</span><span class='line'>    <span class="nx">fs</span><span class="p">.</span><span class="nx">writeFileSync</span><span class="p">(</span><span class="s1">&#39;schema.json&#39;</span><span class="p">,</span> <span class="nx">app</span><span class="p">.</span><span class="nx">schema</span><span class="p">());</span>
</span><span class='line'>    <span class="nx">fs</span><span class="p">.</span><span class="nx">writeFileSync</span><span class="p">(</span><span class="s1">&#39;utterances.txt&#39;</span><span class="p">,</span> <span class="nx">app</span><span class="p">.</span><span class="nx">utterances</span><span class="p">());</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Development.and.Test"></a>
<h3>Development and Test</h3>

<p>Running the server locally with <code>node server.js</code> will create a simulator console on http://localhost:8080/alexa/artsy.</p>

<p><img src="/images/2016-11-30-bringing-artsy-to-amazon-echo-alexa/console.png" alt="lambda configuration" /></p>

<p>We will use the test console to produce test JSON. The about intent translates into the following.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="nt">&quot;session&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="nt">&quot;sessionId&quot;</span><span class="p">:</span> <span class="s2">&quot;SessionId...&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="nt">&quot;application&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nt">&quot;applicationId&quot;</span><span class="p">:</span> <span class="s2">&quot;amzn1.ask.skill...&quot;</span>
</span><span class='line'>        <span class="p">},</span>
</span><span class='line'>        <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{},</span>
</span><span class='line'>        <span class="nt">&quot;user&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nt">&quot;userId&quot;</span><span class="p">:</span> <span class="s2">&quot;amzn1.ask.account...&quot;</span>
</span><span class='line'>        <span class="p">},</span>
</span><span class='line'>        <span class="nt">&quot;new&quot;</span><span class="p">:</span> <span class="kc">true</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nt">&quot;request&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;IntentRequest&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="nt">&quot;requestId&quot;</span><span class="p">:</span> <span class="s2">&quot;EdwRequestId...&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="nt">&quot;locale&quot;</span><span class="p">:</span> <span class="s2">&quot;en-US&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="nt">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2016-11-12T22:03:54Z&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="nt">&quot;intent&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>            <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;AboutIntent&quot;</span><span class="p">,</span>
</span><span class='line'>            <span class="nt">&quot;slots&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>                <span class="nt">&quot;VALUE&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>                    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;VALUE&quot;</span><span class="p">,</span>
</span><span class='line'>                    <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;Norman Rockwell&quot;</span>
</span><span class='line'>                <span class="p">}</span>
</span><span class='line'>            <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">},</span>
</span><span class='line'>    <span class="nt">&quot;version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0&quot;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>A mocha test uses the Alexa app server to make an HTTP request using the above intent data and expects well defined SSML output.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">chai</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;chai&#39;</span><span class="p">);</span>
</span><span class='line'><span class="nx">expect</span> <span class="o">=</span> <span class="nx">chai</span><span class="p">.</span><span class="nx">expect</span><span class="p">;</span>
</span><span class='line'><span class="nx">chai</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;chai-string&#39;</span><span class="p">));</span>
</span><span class='line'><span class="nx">chai</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;chai-http&#39;</span><span class="p">));</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">server</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;../server&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">describe</span><span class="p">(</span><span class="s1">&#39;artsy alexa&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">it</span><span class="p">(</span><span class="s1">&#39;tells me about Norman Rockwell&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">aboutIntentRequest</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;./AboutIntentRequest.json&#39;</span><span class="p">);</span>
</span><span class='line'>        <span class="nx">chai</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="nx">server</span><span class="p">)</span>
</span><span class='line'>            <span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/alexa/artsy&#39;</span><span class="p">)</span>
</span><span class='line'>            <span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">aboutIntentRequest</span><span class="p">)</span>
</span><span class='line'>            <span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>                <span class="nx">expect</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
</span><span class='line'>                <span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">text</span><span class="p">);</span>
</span><span class='line'>                <span class="nx">expect</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">outputSpeech</span><span class="p">.</span><span class="nx">type</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">equal</span><span class="p">(</span><span class="s1">&#39;SSML&#39;</span><span class="p">)</span>
</span><span class='line'>                <span class="kd">var</span> <span class="nx">ssml</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">response</span><span class="p">.</span><span class="nx">outputSpeech</span><span class="p">.</span><span class="nx">ssml</span><span class="p">;</span>
</span><span class='line'>              <span class="nx">expect</span><span class="p">(</span><span class="nx">ssml</span><span class="p">).</span><span class="nx">to</span><span class="p">.</span><span class="nx">startWith</span><span class="p">(</span><span class="s1">&#39;&lt;speak&gt;American artist Norman Rockwell &#39;</span><span class="p">);</span>
</span><span class='line'>              <span class="nx">done</span><span class="p">();</span>
</span><span class='line'>            <span class="p">});</span>
</span><span class='line'>    <span class="p">});</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Lambda.Deployment"></a>
<h3>Lambda Deployment</h3>

<p>The production version of the Alexa skill is a Lambda function.</p>

<p>I created an "alexa-artsy" function with a new IAM role, "alexa-artsy" in AWS Lambda and copy-pasted the role URN into "project.json". This is a file used by <a href="https://github.com/apex/apex">Apex</a>, a Lambda deployment tool (<code>curl https://raw.githubusercontent.com/apex/apex/master/install.sh | sh</code>) along with awscli (<code>brew install awscli</code>). I had to configure access to AWS the first time, too (<code>aws configure</code>).</p>

<p><img src="/images/2016-11-30-bringing-artsy-to-amazon-echo-alexa/lambda-configuration.png" alt="lambda configuration" /></p>

<p>In order to connect the lambda function with an Alexa skill, I added an "Alexa Skills Kit" trigger. Without this you get an obscure "Please make sure that Alexa Skills Kit is selected for the event source type of arn:..." error.</p>

<p><img src="/images/2016-11-30-bringing-artsy-to-amazon-echo-alexa/lambda-triggers.png" alt="lambda triggers" /></p>

<p>I configured the "Service Endpoint" in the Alexa Skill configuration to point to my Lambda function.</p>

<p><img src="/images/2016-11-30-bringing-artsy-to-amazon-echo-alexa/alexa-skill-configuration.png" alt="Alexa skill configuration" /></p>

<p>I deployed the lambda function with <code>apex deploy</code> and test the skill with <code>apex invoke</code> or from the Alexa test UI.</p>

<p>Each time we do a <code>apex deploy</code> it will create a new version of our function and will update <code>$LATEST</code> <a href="http://docs.aws.amazon.com/lambda/latest/dg/versioning-aliases.html">Lambda alias</a>. One way to handle versioning is to create a <code>$PROD</code> Lambda alias and point to <code>$PROD</code> when setting function in "Service Endpoint" step and each time we want to upate prod we need to update <code>$PROD</code> alias to point to latest version.</p>

<p>Also note that after each deploy with apex we need to set environment variables for the newly created version.</p>

<p>Logs didn't appear in AWS Cloudwatch with the execution policy created by default, I had to give the IAM "alexa-artsy" role more access to "arn:aws:logs:<em>:</em>:*" via an additional inline policy.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="nt">&quot;Version&quot;</span><span class="p">:</span> <span class="s2">&quot;2012-10-17&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;Statement&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span class='line'>    <span class="p">{</span>
</span><span class='line'>      <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span>
</span><span class='line'>      <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span class='line'>        <span class="s2">&quot;logs:CreateLogGroup&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;logs:CreateLogStream&quot;</span><span class="p">,</span>
</span><span class='line'>        <span class="s2">&quot;logs:PutLogEvents&quot;</span>
</span><span class='line'>      <span class="p">],</span>
</span><span class='line'>      <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="s2">&quot;arn:aws:logs:*:*:*&quot;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">]</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<a name="Testing.with.Echoism"></a>
<h3>Testing with Echoism</h3>

<p>You can use <a href="https://echosim.io">echosim.io</a> to test your skill. It's essentially identical to an Echo.</p>

<a name="Testing.with.Echo"></a>
<h3>Testing with Echo</h3>

<p>I got an Echo Dot. Test skills appear automatically in the Alexa configuration attached to my account!</p>

<p><img src="/images/2016-11-30-bringing-artsy-to-amazon-echo-alexa/alexa-skills.png" alt="alexa skills" /></p>

<p>I just try to <a href="https://www.youtube.com/watch?v=FYVOAU35Sio">talk to it</a>.</p>

<a name="Certification.Process"></a>
<h3>Certification Process</h3>

<p><img src="/images/2016-11-30-bringing-artsy-to-amazon-echo-alexa/certified-email.png" alt="certified email" /></p>

<p>This took several weeks of back-and-forth. I should have gone through the <a href="https://developer.amazon.com/public/solutions/alexa/alexa-skills-kit/docs/alexa-skills-kit-voice-interface-and-user-experience-testing">Alexa Skills Kit Voice Interface and User Experience Testing for Custom Skills</a> more thoroughly, but even after reading it a few times it wasn't obvious what the reviewers wanted.</p>

<p><img src="/images/2016-11-30-bringing-artsy-to-amazon-echo-alexa/certified-dashboard.png" alt="certified dashboard" /></p>

<p>Keep in mind that you need to go through certification process only if you are changing descriptions and details of the skill. If you updated the lambda function without modifying <code>utterances</code> or <code>schema</code> you don't have to go through certification process.</p>

<p>Here's a list of my mistakes.</p>

<a name="Sample.Phrases"></a>
<h4>Sample Phrases</h4>

<p>The <em>Example Phrases</em> in the <em>Publishing Information</em> section of the certification UI must be present in your sample utterances. My three examples are <em>"Alexa, ask Artsy about Artsy"</em>, <em>"Alexa, ask Artsy about Andy Warhol"</em> and <em>"Alexa, ask Artsy about Norman Rockwell"</em>.</p>

<p>The sample utterances are in the <em>Interaction Model</em> section and must not include the wake word or any relevant launch phrasing. In the Artsy app I only have a single utterance with <em>"AboutIntent about {VALUE}"</em>, but lots of entries for <em>VALUE</em> in the custom slot type. I forgot to include <em>artsy</em> and <em>Norman Rockwell</em> in those.</p>

<p>The skill got rejected mutliple times with <em>about artsy</em> not working, so I eventually gave up on supporting that. Alexa would recognize it as <em>artsee</em>, <em>artzi</em> and many other variations. I suspect testers pronounce it <em>artsay</em> or <em>artsai</em> and never get the correct response.</p>

<a name="The.Opening.Line"></a>
<h4>The Opening Line</h4>

<p>The welcome prompt is required, and must describe what users can ask of the skill and the session must remain open for a user response. This means that in order to get your app certified you must build some kind of basic conversational ability. My first cut simply said <em>"Welcome to Artsy"</em>, which wasn't good enough. I added a prompt, <em>"Ask me about an artist."</em> and included <code>shouldEndSession(false)</code> in the code.</p>

<a name="Stop.and.Cancel.Intents"></a>
<h4>Stop and Cancel Intents</h4>

<p>The skill must exit appropriately when users say <em>"stop"</em> or <em>"cancel"</em>. This means you must build at the very least an <em>AMAZON.StopIntent</em>, <em>AMAZON.CancelIntent</em>. In my first iteration a user would say <em>"Alexa open Artsy"</em>, then <em>"stop"</em> and would get <em>"Sorry, I didn't get that artist name."</em>.</p>

<a name="Help.Intent"></a>
<h4>Help Intent</h4>

<p>The skill must also implement <em>AMAZON.HelpIntent</em> as a question. In my first iteration a user would say <em>"Alexa open Artsy"</em>, then <em>"help"</em> and would get <em>"Sorry, I didn't get that artist name."</em>. Then help would say something like <em>"You can ask me about Artsy. Say cancel or stop at any time."</em> The certification process requires a prompt, eg. <em>"What artist would you like to hear about?"</em> and the session must remain open via <code>shouldEndSession(false)</code>.</p>

<a name="Skill.and.Code"></a>
<h3>Skill and Code</h3>

<p>Find the <a href="http://alexa.amazon.com/spa/index.html#skills/dp/B01MYLJO1N">Artsy skill in the Alexa app</a>.</p>

<p>Find the <a href="https://github.com/artsy/elderfield">complete Skill code on Github</a>.</p>
</div>
    

    
      <p class="meta-author">
        
  





<div class="meta">
  Posted by


  

  
    <span class="byline author vcard">

      <div class="meta"><span class="fn"><a href="/author/db">
        Daniel Doubrovkine
      </a></span></div>

      
      <span class="fn">
        <a href="http://code.dblock.org">Site</a>
      </span>
      
      
      <span class="fn">
        <a href="https://github.com/dblock">GitHub</a>
      </span>
      
      
      <span class="fn">
        <a href="https://twitter.com/dblockdotorg">@dblockdotorg</a>
      </span>
      
    </span>

  
</div>




      </p>
      <p class="meta-categories">
        Categories: 

<span class="categories">
  
    <a class='category' href='/blog/categories/alexa/'>alexa</a>, <a class='category' href='/blog/categories/amazon-echo/'>amazon echo</a>
  
</span>


      </p>
      

      
        <hr/>
        <section class="comments">
          <h1>Comments</h1>
          <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
        </section>
        <hr/>
      

      <p class="meta-paginate">
        
          <a class="previous" href="/blog/2016/11/14/JS-Glossary/" title="Previous Post: JavaScript Glossary for 2017">&laquo; JavaScript Glossary for 2017</a>
        
        
          <a class="next" href="/blog/2017/01/04/OSS-FAQ/" title="next Post: Open Source FAQ for Engineers">Open Source FAQ for Engineers &raquo;</a>
        
      </p>
    
  </div>


  <footer>
  </footer>

</div>


  </article>
</div>


    </div>
  </div>
  <footer id="main_footer"> <div class="footer-navigation">
  <ul>
    <li><a href="https://developers.artsy.net/">API</a></li>
    <li><a href="https://www.artsy.net/jobs">Careers</a></li>
    <li><a href="http://twitter.com/artsyopensource">@artsyopensource</a></li>
    <li><a href="http://www.artsy.net/">Artsy.net</a></li>
  </ul>
</div>



<script type="text/javascript">
      var disqus_shortname = 'artsy';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://artsy.github.io/blog/2016/11/30/bringing-artsy-to-amazon-echo-alexa/';
        var disqus_url = 'http://artsy.github.io/blog/2016/11/30/bringing-artsy-to-amazon-echo-alexa/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


</footer>
  <script type="text/javascript">
  $(function() {
    // TODO: Move this whole file to a javascript file that is included in the footer

    // Main sticky header
    if ($(window).width() >= 700) {
      var sticky = new Waypoint.Sticky({
        element: $("#banner"),
        offset: -100
      });
    }

    // Toggle hamburger menu
    $('.header-hamburger').click(function() {
      $('#banner, .cmn-toggle-switch').toggleClass('active');
      if (location.pathname == '/open-source') {
        $('.header-search span').hide();
        $('#page-sidebar').toggle();
      }
    });

    // Toggle search focus on mobile
    $('input.search').focus(function() {
      $('#header').addClass('search-focused');
    }).blur(function() {
      $('#header').removeClass('search-focused');
    });
  });
</script>

</body>
</html>
